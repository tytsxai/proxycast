---
title: MCP 服务器
description: Model Context Protocol 集成
navigation:
  icon: i-heroicons-puzzle-piece
---

# MCP 服务器

MCP (Model Context Protocol) 是一种标准协议，允许 AI 模型与外部工具和数据源交互。

## MCP 概念

### 什么是 MCP

MCP 定义了 AI 模型与外部系统交互的标准方式：

- **工具调用**: AI 可以调用外部工具执行操作
- **资源访问**: AI 可以读取外部数据源
- **上下文扩展**: 为 AI 提供额外的上下文信息

### 集成优势

- 扩展 AI 能力，执行实际操作
- 访问实时数据和外部服务
- 标准化的工具接口

## 服务器配置

### 添加 MCP 服务器

1. 进入 **MCP** 页面
2. 点击 **添加服务器**
3. 配置服务器信息：

| 字段 | 说明 |
|------|------|
| 名称 | 服务器标识名称 |
| 命令 | 启动命令 |
| 参数 | 命令参数 |
| 环境变量 | 环境变量配置 |

### 配置示例

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-filesystem", "/path/to/dir"],
      "env": {}
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "your-token"
      }
    }
  }
}
```

### 连接设置

| 选项 | 说明 |
|------|------|
| 自动启动 | 应用启动时自动连接 |
| 重连间隔 | 断开后重连的等待时间 |
| 超时时间 | 连接超时设置 |

## 工具调用

### 可用工具

连接 MCP 服务器后，可以查看提供的工具：

1. 进入 **MCP** 页面
2. 选择已连接的服务器
3. 查看 **工具列表**

### 工具信息

每个工具显示：

- 工具名称
- 功能描述
- 输入参数
- 返回类型

### 调用示例

通过 API 调用 MCP 工具：

```bash
curl http://127.0.0.1:9090/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-api-key" \
  -d '{
    "model": "claude-sonnet-4-20250514",
    "messages": [
      {"role": "user", "content": "读取 /tmp/test.txt 文件内容"}
    ],
    "tools": [
      {
        "type": "function",
        "function": {
          "name": "read_file",
          "description": "读取文件内容",
          "parameters": {
            "type": "object",
            "properties": {
              "path": {"type": "string"}
            }
          }
        }
      }
    ]
  }'
```

## 常用 MCP 服务器

### 文件系统

```json
{
  "filesystem": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-filesystem", "/allowed/path"]
  }
}
```

### GitHub

```json
{
  "github": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-github"],
    "env": {
      "GITHUB_TOKEN": "ghp_xxx"
    }
  }
}
```

### 数据库

```json
{
  "postgres": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-postgres"],
    "env": {
      "DATABASE_URL": "postgresql://..."
    }
  }
}
```

## 服务器管理

### 启动/停止

- **启动**: 点击服务器的 **启动** 按钮
- **停止**: 点击 **停止** 按钮
- **重启**: 点击 **重启** 按钮

### 状态监控

| 状态 | 说明 |
|------|------|
| 🟢 已连接 | 服务器正常运行 |
| 🔴 已断开 | 服务器未连接 |
| 🟡 连接中 | 正在建立连接 |

### 日志查看

查看 MCP 服务器的运行日志：

1. 选择服务器
2. 点击 **查看日志**
3. 实时显示服务器输出
